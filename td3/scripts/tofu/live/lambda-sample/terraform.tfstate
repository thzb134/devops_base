{"version":4,"terraform_version":"1.9.0","serial":6,"lineage":"b08b66b5-7c25-3750-90be-d86bb00b5b17","outputs":{"api_endpoint":{"value":"https://brqsfxynid.execute-api.us-east-2.amazonaws.com","type":"string"}},"resources":[{"module":"module.function","mode":"data","type":"archive_file","name":"source_code","provider":"provider[\"registry.opentofu.org/hashicorp/archive\"]","instances":[{"schema_version":0,"attributes":{"exclude_symlink_directories":null,"excludes":null,"id":"a5dd57c8b10e70a718102536399249904d8d4d8d","output_base64sha256":"ttl6U2sR5yfASVYGlkcpGDXWhNeDAq0lEI9wRqqjwnI=","output_base64sha512":"mapAZtR7guyc3LWMJPCQw6grp36fnoJwXMHNfsJgGZNeI3TZ0UPL+C1BYqi6I825NIh/Z2cjZKIqawW815umuA==","output_file_mode":null,"output_md5":"e5aaa00686cfa5cdd3befff6d71721de","output_path":".terraform/modules/function/ch3/tofu/modules/lambda/lambda-sample.zip","output_sha":"a5dd57c8b10e70a718102536399249904d8d4d8d","output_sha256":"b6d97a536b11e727c04956069647291835d684d78302ad25108f7046aaa3c272","output_sha512":"99aa4066d47b82ec9cdcb58c24f090c3a82ba77e9f9e82705cc1cd7ec26019935e2374d9d143cbf82d4162a8ba23cdb934887f67672364a22a6b05bcd79ba6b8","output_size":231,"source":[],"source_content":null,"source_content_filename":null,"source_dir":"./src","source_file":null,"type":"zip"},"sensitive_attributes":[]}]},{"module":"module.function","mode":"data","type":"aws_iam_policy_document","name":"allow_logging","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"16712114","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:*\"\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":[\"logs:PutLogEvents\",\"logs:CreateLogStream\",\"logs:CreateLogGroup\"],\"Resource\":\"arn:aws:logs:*:*:*\"}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["arn:aws:logs:*:*:*"],"sid":""}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"module":"module.function","mode":"data","type":"aws_iam_policy_document","name":"policy","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"2690255455","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRole\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["lambda.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"module":"module.function","mode":"managed","type":"aws_iam_role","name":"lambda","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:iam::503561451093:role/lambda-sample","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-01-19T14:12:49Z","description":"","force_detach_policies":false,"id":"lambda-sample","inline_policy":[{"name":"lambda-sample-allow-logging","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:PutLogEvents\",\"logs:CreateLogStream\",\"logs:CreateLogGroup\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:logs:*:*:*\"}]}"}],"managed_policy_arns":[],"max_session_duration":3600,"name":"lambda-sample","name_prefix":"","path":"/","permissions_boundary":"","tags":{},"tags_all":{},"unique_id":"AROAXKPUZ6ZK5MSVVZRXX"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.function.data.aws_iam_policy_document.policy"]}]},{"module":"module.function","mode":"managed","type":"aws_iam_role_policy","name":"allow_logging","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"lambda-sample:lambda-sample-allow-logging","name":"lambda-sample-allow-logging","name_prefix":"","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:PutLogEvents\",\"logs:CreateLogStream\",\"logs:CreateLogGroup\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:logs:*:*:*\"}]}","role":"lambda-sample"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.function.aws_iam_role.lambda","module.function.data.aws_iam_policy_document.allow_logging","module.function.data.aws_iam_policy_document.policy"]}]},{"module":"module.function","mode":"managed","type":"aws_lambda_function","name":"function","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"architectures":["x86_64"],"arn":"arn:aws:lambda:us-east-2:503561451093:function:lambda-sample","code_signing_config_arn":"","dead_letter_config":[],"description":"","environment":[{"variables":{"NODE_ENV":"production"}}],"ephemeral_storage":[{"size":512}],"file_system_config":[],"filename":".terraform/modules/function/ch3/tofu/modules/lambda/lambda-sample.zip","function_name":"lambda-sample","handler":"index.handler","id":"lambda-sample","image_config":[],"image_uri":"","invoke_arn":"arn:aws:apigateway:us-east-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-2:503561451093:function:lambda-sample/invocations","kms_key_arn":"","last_modified":"2025-01-19T14:19:36.000+0000","layers":[],"logging_config":[{"application_log_level":"","log_format":"Text","log_group":"/aws/lambda/lambda-sample","system_log_level":""}],"memory_size":128,"package_type":"Zip","publish":false,"qualified_arn":"arn:aws:lambda:us-east-2:503561451093:function:lambda-sample:$LATEST","qualified_invoke_arn":"arn:aws:apigateway:us-east-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-2:503561451093:function:lambda-sample:$LATEST/invocations","replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"role":"arn:aws:iam::503561451093:role/lambda-sample","runtime":"python3.9","s3_bucket":null,"s3_key":null,"s3_object_version":null,"signing_job_arn":"","signing_profile_version_arn":"","skip_destroy":false,"snap_start":[],"source_code_hash":"ttl6U2sR5yfASVYGlkcpGDXWhNeDAq0lEI9wRqqjwnI=","source_code_size":231,"tags":{},"tags_all":{},"timeout":5,"timeouts":null,"tracing_config":[{"mode":"PassThrough"}],"version":"$LATEST","vpc_config":[]},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19","dependencies":["module.function.aws_iam_role.lambda","module.function.data.archive_file.source_code","module.function.data.aws_iam_policy_document.policy"]}]},{"module":"module.gateway","mode":"managed","type":"aws_apigatewayv2_api","name":"api","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"api_endpoint":"https://brqsfxynid.execute-api.us-east-2.amazonaws.com","api_key_selection_expression":"$request.header.x-api-key","arn":"arn:aws:apigateway:us-east-2::/apis/brqsfxynid","body":null,"cors_configuration":[],"credentials_arn":null,"description":"","disable_execute_api_endpoint":false,"execution_arn":"arn:aws:execute-api:us-east-2:503561451093:brqsfxynid","fail_on_warnings":null,"id":"brqsfxynid","name":"lambda-sample","protocol_type":"HTTP","route_key":null,"route_selection_expression":"$request.method $request.path","tags":{},"tags_all":{},"target":null,"version":""},"sensitive_attributes":[],"private":"bnVsbA=="}]},{"module":"module.gateway","mode":"managed","type":"aws_apigatewayv2_integration","name":"lambda","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"api_id":"brqsfxynid","connection_id":"","connection_type":"INTERNET","content_handling_strategy":"","credentials_arn":"","description":"","id":"mlb4nr4","integration_method":"POST","integration_response_selection_expression":"","integration_subtype":"","integration_type":"AWS_PROXY","integration_uri":"arn:aws:lambda:us-east-2:503561451093:function:lambda-sample","passthrough_behavior":"","payload_format_version":"1.0","request_parameters":{},"request_templates":{},"response_parameters":[],"template_selection_expression":"","timeout_milliseconds":30000,"tls_config":[]},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.function.aws_iam_role.lambda","module.function.aws_lambda_function.function","module.function.data.archive_file.source_code","module.function.data.aws_iam_policy_document.policy","module.gateway.aws_apigatewayv2_api.api"]}]},{"module":"module.gateway","mode":"managed","type":"aws_apigatewayv2_route","name":"lambda_route","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":"GET /","schema_version":0,"attributes":{"api_id":"brqsfxynid","api_key_required":false,"authorization_scopes":[],"authorization_type":"NONE","authorizer_id":"","id":"g6jw3wg","model_selection_expression":"","operation_name":"","request_models":{},"request_parameter":[],"route_key":"GET /","route_response_selection_expression":"","target":"integrations/mlb4nr4"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.function.aws_iam_role.lambda","module.function.aws_lambda_function.function","module.function.data.archive_file.source_code","module.function.data.aws_iam_policy_document.policy","module.gateway.aws_apigatewayv2_api.api","module.gateway.aws_apigatewayv2_integration.lambda"]}]},{"module":"module.gateway","mode":"managed","type":"aws_apigatewayv2_stage","name":"default","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"access_log_settings":[],"api_id":"brqsfxynid","arn":"arn:aws:apigateway:us-east-2::/apis/brqsfxynid/stages/$default","auto_deploy":true,"client_certificate_id":"","default_route_settings":[{"data_trace_enabled":false,"detailed_metrics_enabled":false,"logging_level":"","throttling_burst_limit":10000,"throttling_rate_limit":10000}],"deployment_id":"9x8mwc","description":"","execution_arn":"arn:aws:execute-api:us-east-2:503561451093:brqsfxynid/$default","id":"$default","invoke_url":"https://brqsfxynid.execute-api.us-east-2.amazonaws.com/","name":"$default","route_settings":[],"stage_variables":{},"tags":{},"tags_all":{}},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.gateway.aws_apigatewayv2_api.api"]}]},{"module":"module.gateway","mode":"managed","type":"aws_lambda_permission","name":"allow_invoke","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":"GET /","schema_version":0,"attributes":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"arn:aws:lambda:us-east-2:503561451093:function:lambda-sample","function_url_auth_type":null,"id":"AllowAPIGatewayToCallSampleAppLambda","principal":"apigateway.amazonaws.com","principal_org_id":null,"qualifier":"","source_account":null,"source_arn":"arn:aws:execute-api:us-east-2:503561451093:brqsfxynid/*/GET/","statement_id":"AllowAPIGatewayToCallSampleAppLambda","statement_id_prefix":""},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.function.aws_iam_role.lambda","module.function.aws_lambda_function.function","module.function.data.archive_file.source_code","module.function.data.aws_iam_policy_document.policy","module.gateway.aws_apigatewayv2_api.api"]}]}],"check_results":null}
